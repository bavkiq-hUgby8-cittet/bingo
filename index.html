<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ Bingo dos Veloso - Operador</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Fredoka+One&family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--red:#ff6b6b;--cyan:#4ecdc4;--yellow:#ffe66d;--purple:#a855f7;--green:#22c55e;--blue:#3b82f6;--pink:#ec4899;--orange:#f97316}
        body{font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);min-height:100vh;color:#fff;overflow-x:hidden}
        .header{display:flex;justify-content:space-between;align-items:center;padding:20px 40px;background:linear-gradient(90deg,rgba(255,107,107,.3),rgba(78,205,196,.3),rgba(255,230,109,.3));border-bottom:3px solid rgba(255,255,255,.2)}
        .logo{font-family:'Bangers',cursive;font-size:3rem;background:linear-gradient(135deg,#ffd700,#ff6b6b,#4ecdc4,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:rainbow 3s ease infinite;background-size:300% 300%}
        @keyframes rainbow{0%,100%{background-position:0 50%}50%{background-position:100% 50%}}
        .btn{padding:12px 24px;border:none;border-radius:50px;font-weight:700;cursor:pointer;transition:.3s;font-size:1rem}
        .btn-reset{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}
        .btn-reset:hover{transform:scale(1.05);box-shadow:0 6px 20px rgba(239,68,68,.4)}
        .container{max-width:1600px;margin:0 auto;padding:30px}
        .card{background:linear-gradient(135deg,rgba(255,255,255,.1),rgba(255,255,255,.05));backdrop-filter:blur(20px);border-radius:30px;padding:30px;border:2px solid rgba(255,255,255,.1);box-shadow:0 20px 60px rgba(0,0,0,.3)}
        .card-title{font-family:'Fredoka One',cursive;font-size:1.8rem;margin-bottom:25px;color:var(--yellow);display:flex;align-items:center;gap:15px}
        .card-title span{font-size:2.5rem;animation:bounce 1s ease infinite}
        @keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        .tela-inicial{display:grid;grid-template-columns:1fr 1fr;gap:30px}
        .form-group{margin-bottom:25px}
        .form-group label{display:block;margin-bottom:10px;font-weight:700;font-size:1.1rem}
        .form-group input{width:100%;padding:18px 24px;border:3px solid rgba(255,255,255,.2);border-radius:15px;background:rgba(255,255,255,.1);color:#fff;font-size:1.1rem}
        .form-group input:focus{outline:none;border-color:var(--yellow);box-shadow:0 0 30px rgba(255,230,109,.3)}
        .premio-upload{text-align:center;padding:30px;border:3px dashed rgba(255,215,0,.5);border-radius:20px;background:rgba(255,215,0,.1);cursor:pointer}
        .premio-upload:hover{border-color:var(--yellow);background:rgba(255,215,0,.2)}
        .premio-preview{width:150px;height:150px;border-radius:20px;object-fit:cover;margin:0 auto 15px;display:block;border:4px solid var(--yellow)}
        .premio-icon{font-size:4rem;margin-bottom:15px}
        .slider-container{display:flex;align-items:center;gap:20px;padding:15px;background:rgba(255,255,255,.1);border-radius:15px}
        .slider-container input[type=range]{flex:1;height:12px;-webkit-appearance:none;background:linear-gradient(90deg,var(--red),var(--cyan));border-radius:6px;border:none}
        .slider-container input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:30px;height:30px;background:linear-gradient(135deg,#ffd700,#ffa500);border-radius:50%;cursor:pointer;box-shadow:0 4px 15px rgba(255,215,0,.5);border:3px solid #fff}
        .slider-value{font-family:'Bangers',cursive;font-size:2.5rem;color:var(--yellow);min-width:60px;text-align:center}
        .btn-primary{width:100%;padding:20px;background:linear-gradient(135deg,var(--green),#16a34a);border:none;border-radius:20px;color:#fff;font-family:'Fredoka One',cursive;font-size:1.5rem;cursor:pointer;box-shadow:0 8px 25px rgba(34,197,94,.4)}
        .btn-primary:hover{transform:translateY(-3px);box-shadow:0 12px 35px rgba(34,197,94,.6)}
        .salas-lista{display:grid;gap:25px;max-height:600px;overflow-y:auto}
        .sala-card{background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));border-radius:25px;padding:25px;border:2px solid rgba(255,255,255,.1)}
        .sala-card:hover{border-color:var(--yellow);transform:translateY(-5px)}
        .sala-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .sala-nome{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--yellow)}
        .sala-premio{width:60px;height:60px;border-radius:15px;object-fit:cover;border:3px solid var(--yellow)}
        .sala-info{display:flex;gap:20px;margin-bottom:20px;flex-wrap:wrap}
        .sala-info-item{display:flex;align-items:center;gap:8px;padding:8px 15px;background:rgba(255,255,255,.1);border-radius:10px}
        .qr-container{display:flex;justify-content:center;margin:20px 0;background:#fff;padding:20px;border-radius:20px;width:fit-content;margin-left:auto;margin-right:auto}
        .sala-buttons{display:grid;grid-template-columns:1fr 1fr;gap:12px}
        .btn-sala{padding:14px 20px;border:none;border-radius:15px;font-weight:700;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;gap:8px}
        .btn-iniciar{background:linear-gradient(135deg,var(--green),#16a34a);color:#fff;grid-column:span 2}
        .btn-jogadores{background:linear-gradient(135deg,var(--blue),#2563eb);color:#fff}
        .btn-encerrar{background:linear-gradient(135deg,var(--red),#dc2626);color:#fff}
        .btn-sala:hover{transform:scale(1.03)}
        .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);z-index:1000;align-items:center;justify-content:center;backdrop-filter:blur(10px)}
        .modal.active{display:flex}
        .modal-content{background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:30px;padding:40px;max-width:900px;width:90%;max-height:80vh;overflow-y:auto;border:3px solid rgba(255,255,255,.2);position:relative}
        .modal-close{position:absolute;top:20px;right:20px;width:50px;height:50px;border-radius:50%;background:rgba(255,255,255,.1);border:none;color:#fff;font-size:2rem;cursor:pointer}
        .modal-close:hover{background:var(--red);transform:rotate(90deg)}
        .regras-title{font-family:'Bangers',cursive;font-size:3rem;color:var(--yellow);margin-bottom:30px;text-align:center}
        .regras-lista{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:30px}
        .regra-item{background:rgba(255,255,255,.1);border-radius:20px;padding:25px 15px;text-align:center;border:2px solid rgba(255,255,255,.2)}
        .regra-icon{font-size:3rem;margin-bottom:15px}
        .regra-titulo{font-family:'Fredoka One',cursive;font-size:1.1rem;color:var(--yellow);margin-bottom:10px}
        .regra-desc{font-size:.9rem;color:rgba(255,255,255,.8)}
        .btn-iniciar-jogo{padding:25px 60px;font-size:1.8rem;font-family:'Bangers',cursive;background:linear-gradient(135deg,var(--green),#16a34a);color:#fff;border:none;border-radius:20px;cursor:pointer;letter-spacing:3px;box-shadow:0 10px 40px rgba(34,197,94,.5);display:block;margin:0 auto}
        .btn-iniciar-jogo:hover{transform:scale(1.05)}
        .tela-jogo{display:none}
        .tela-jogo.active{display:block}
        .jogo-header{text-align:center;margin-bottom:30px}
        .jogo-titulo{font-family:'Bangers',cursive;font-size:3.5rem;background:linear-gradient(135deg,#ffd700,#ff6b6b,#4ecdc4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:rainbow 3s ease infinite;background-size:300% 300%}
        .premio-destaque{display:flex;align-items:center;justify-content:center;gap:20px;margin-top:20px}
        .premio-img-grande{width:100px;height:100px;border-radius:20px;object-fit:cover;border:4px solid var(--yellow);animation:float 3s ease-in-out infinite}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        .premio-texto{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--yellow)}
        .globo-section{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:30px 0}
        .globo-container{position:relative;width:400px;height:400px}
        .globo-esfera{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:350px;height:350px;border-radius:50%;background:linear-gradient(135deg,#2d3748,#1a202c,#0d1117);box-shadow:inset -30px -30px 60px rgba(0,0,0,.8),inset 30px 30px 60px rgba(255,255,255,.1),0 30px 60px rgba(0,0,0,.5);border:8px solid #4a5568;overflow:hidden}
        .globo-esfera::before{content:'';position:absolute;top:10%;left:15%;width:80px;height:80px;background:radial-gradient(circle,rgba(255,255,255,.4),transparent);border-radius:50%}
        .bola-bingo{position:absolute;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1rem;box-shadow:inset -5px -5px 15px rgba(0,0,0,.3),inset 5px 5px 15px rgba(255,255,255,.5),3px 3px 10px rgba(0,0,0,.3);transition:.3s}
        .bola-b{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}
        .bola-i{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}
        .bola-n{background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff}
        .bola-g{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}
        .bola-o{background:linear-gradient(135deg,#a855f7,#9333ea);color:#fff}
        .numero-sorteado-container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:100;display:none}
        .numero-sorteado-container.active{display:block}
        .bola-sorteada{width:260px;height:260px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:inset -20px -20px 40px rgba(0,0,0,.4),inset 20px 20px 40px rgba(255,255,255,.4),0 30px 60px rgba(0,0,0,.5),0 0 100px rgba(255,215,0,.5);animation:entrada-bola .8s cubic-bezier(.68,-.55,.265,1.55)}
        @keyframes entrada-bola{0%{transform:scale(0) rotate(-180deg);opacity:0}100%{transform:scale(1) rotate(0);opacity:1}}
        .letra-grande{font-family:'Bangers',cursive;font-size:6rem;color:#fff;text-shadow:4px 4px 8px rgba(0,0,0,.5);line-height:1;animation:pulse-letra .5s ease infinite}
        @keyframes pulse-letra{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
        .numero-grande{font-family:'Bangers',cursive;font-size:8rem;color:#fff;text-shadow:4px 4px 8px rgba(0,0,0,.5);line-height:1;opacity:0}
        .numero-grande.visible{opacity:1;animation:entrada-numero .5s cubic-bezier(.68,-.55,.265,1.55)}
        @keyframes entrada-numero{0%{transform:scale(3);opacity:0}100%{transform:scale(1);opacity:1}}
        .btn-sortear{padding:25px 70px;font-size:1.8rem;font-family:'Bangers',cursive;background:linear-gradient(135deg,var(--red),#dc2626);color:#fff;border:none;border-radius:30px;cursor:pointer;box-shadow:0 10px 40px rgba(239,68,68,.5);margin-top:30px}
        .btn-sortear:hover:not(:disabled){transform:translateY(-5px) scale(1.05);box-shadow:0 15px 50px rgba(239,68,68,.7)}
        .btn-sortear:disabled{background:#4a5568;cursor:not-allowed;box-shadow:none}
        .btn-sortear.girando{background:linear-gradient(135deg,var(--yellow),var(--orange));animation:pulse-btn .5s ease infinite}
        @keyframes pulse-btn{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .reacoes-container{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);display:flex;gap:15px;z-index:500;flex-wrap:wrap;justify-content:center;max-width:90%}
        .reacao{display:flex;align-items:center;gap:10px;padding:12px 20px;background:linear-gradient(135deg,rgba(34,197,94,.95),rgba(22,163,74,.95));border-radius:50px;animation:pop-reacao .5s cubic-bezier(.68,-.55,.265,1.55),fade-out .5s ease 3s forwards;box-shadow:0 5px 20px rgba(34,197,94,.5)}
        @keyframes pop-reacao{0%{transform:scale(0) translateY(50px);opacity:0}100%{transform:scale(1) translateY(0);opacity:1}}
        @keyframes fade-out{to{opacity:0;transform:translateY(-20px)}}
        .reacao-foto{width:45px;height:45px;border-radius:50%;object-fit:cover;border:2px solid #fff}
        .reacao-nome{font-weight:700;color:#fff;font-size:1.1rem}
        .reacao-icon{font-size:1.5rem}
        .numeros-sorteados-section{margin-top:40px}
        .section-title{font-family:'Fredoka One',cursive;font-size:2rem;margin-bottom:25px;text-align:center;color:var(--yellow)}
        .numeros-grid-container{background:rgba(255,255,255,.05);border-radius:25px;padding:30px;border:2px solid rgba(255,255,255,.1)}
        .letras-header{display:grid;grid-template-columns:repeat(5,1fr);gap:15px;margin-bottom:15px}
        .letra-col{text-align:center;font-family:'Bangers',cursive;font-size:2.5rem;padding:15px;border-radius:15px;color:#fff}
        .letra-col.b{background:linear-gradient(135deg,#ef4444,#dc2626)}
        .letra-col.i{background:linear-gradient(135deg,#f59e0b,#d97706)}
        .letra-col.n{background:linear-gradient(135deg,#22c55e,#16a34a)}
        .letra-col.g{background:linear-gradient(135deg,#3b82f6,#2563eb)}
        .letra-col.o{background:linear-gradient(135deg,#a855f7,#9333ea)}
        .numeros-colunas{display:grid;grid-template-columns:repeat(5,1fr);gap:15px}
        .coluna-numeros{display:grid;gap:8px}
        .numero-cell{padding:12px;text-align:center;font-size:1.2rem;font-weight:700;background:rgba(255,255,255,.1);border-radius:12px}
        .numero-cell.sorteado{color:#fff;box-shadow:0 4px 15px rgba(255,215,0,.5);animation:pop .3s ease}
        .numero-cell.sorteado.b{background:linear-gradient(135deg,#ef4444,#dc2626)}
        .numero-cell.sorteado.i{background:linear-gradient(135deg,#f59e0b,#d97706)}
        .numero-cell.sorteado.n{background:linear-gradient(135deg,#22c55e,#16a34a)}
        .numero-cell.sorteado.g{background:linear-gradient(135deg,#3b82f6,#2563eb)}
        .numero-cell.sorteado.o{background:linear-gradient(135deg,#a855f7,#9333ea)}
        @keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
        .contador-sorteados{text-align:center;margin-top:25px;font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--yellow)}
        .alertas-section{margin-top:40px;background:linear-gradient(135deg,rgba(255,215,0,.2),rgba(255,165,0,.1));border-radius:25px;padding:30px;border:3px solid rgba(255,215,0,.5);animation:glow-border 2s ease infinite}
        @keyframes glow-border{0%,100%{box-shadow:0 0 20px rgba(255,215,0,.3)}50%{box-shadow:0 0 40px rgba(255,215,0,.6)}}
        .alertas-section h3{font-family:'Bangers',cursive;font-size:2rem;color:var(--yellow);margin-bottom:20px}
        .alerta-item{display:flex;justify-content:space-between;align-items:center;padding:20px;background:rgba(255,255,255,.1);border-radius:20px;margin-bottom:15px}
        .alerta-info{display:flex;align-items:center;gap:20px}
        .alerta-foto{width:70px;height:70px;border-radius:50%;object-fit:cover;border:3px solid var(--yellow)}
        .alerta-nome{font-family:'Fredoka One',cursive;font-size:1.4rem}
        .alerta-cartela{color:rgba(255,255,255,.7)}
        .alerta-buttons{display:flex;gap:15px}
        .btn-verificar,.btn-ignorar{padding:15px 30px;border:none;border-radius:15px;font-weight:700;font-size:1.1rem;cursor:pointer}
        .btn-verificar{background:linear-gradient(135deg,var(--green),#16a34a);color:#fff}
        .btn-ignorar{background:rgba(255,255,255,.2);color:#fff}
        .jogador-item{display:flex;align-items:center;justify-content:space-between;padding:20px;background:rgba(255,255,255,.05);border-radius:20px;margin-bottom:15px}
        .jogador-info{display:flex;align-items:center;gap:20px}
        .jogador-foto{width:60px;height:60px;border-radius:50%;object-fit:cover;border:3px solid var(--cyan)}
        .jogador-nome{font-weight:700;font-size:1.2rem}
        .jogador-cartelas-info{color:rgba(255,255,255,.6)}
        .jogador-cartelas-edit{display:flex;align-items:center;gap:15px}
        .cartelas-input{width:80px;padding:10px;border:2px solid rgba(255,255,255,.3);border-radius:10px;background:rgba(255,255,255,.1);color:#fff;font-size:1.2rem;font-weight:700;text-align:center}
        .btn-salvar-cartelas{padding:10px 20px;background:linear-gradient(135deg,var(--green),#16a34a);border:none;border-radius:10px;color:#fff;font-weight:600;cursor:pointer}
        .verificacao-cartela{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin:25px 0}
        .verificacao-header{text-align:center;font-family:'Bangers',cursive;font-size:1.8rem;padding:15px;border-radius:15px;color:#fff}
        .verificacao-header:nth-child(1){background:linear-gradient(135deg,#ef4444,#dc2626)}
        .verificacao-header:nth-child(2){background:linear-gradient(135deg,#f59e0b,#d97706)}
        .verificacao-header:nth-child(3){background:linear-gradient(135deg,#22c55e,#16a34a)}
        .verificacao-header:nth-child(4){background:linear-gradient(135deg,#3b82f6,#2563eb)}
        .verificacao-header:nth-child(5){background:linear-gradient(135deg,#a855f7,#9333ea)}
        .verificacao-cell{aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-size:1.4rem;font-weight:700;border-radius:15px;background:rgba(255,255,255,.1)}
        .verificacao-cell.marcado-correto{background:linear-gradient(135deg,var(--green),#16a34a);color:#fff}
        .verificacao-cell.nao-marcou{background:linear-gradient(135deg,var(--red),#dc2626);color:#fff}
        .verificacao-cell.coringa{background:linear-gradient(135deg,#ffd700,#ffa500);color:#333}
        .verificacao-cell.sequencia{box-shadow:0 0 0 4px var(--yellow),0 0 20px rgba(255,215,0,.5)}
        .resultado-verificacao{text-align:center;padding:30px;border-radius:20px;margin:25px 0}
        .resultado-verificacao.valido{background:linear-gradient(135deg,rgba(34,197,94,.3),rgba(22,163,74,.2));border:3px solid var(--green)}
        .resultado-verificacao.invalido{background:linear-gradient(135deg,rgba(239,68,68,.3),rgba(220,38,38,.2));border:3px solid var(--red)}
        .resultado-titulo{font-family:'Bangers',cursive;font-size:2.5rem;margin-bottom:15px}
        .numeros-perdidos-lista{display:flex;gap:15px;justify-content:center;flex-wrap:wrap;margin-top:20px}
        .numero-perdido{padding:15px 25px;background:rgba(239,68,68,.3);border-radius:15px;font-weight:700;font-size:1.2rem;border:2px solid var(--red)}
        .modal-buttons{display:flex;gap:20px;margin-top:25px}
        .modal-buttons button{flex:1;padding:20px;border:none;border-radius:15px;font-family:'Fredoka One',cursive;font-size:1.3rem;cursor:pointer}
        .btn-vencedor{background:linear-gradient(135deg,#ffd700,#ffa500);color:#333}
        .btn-continuar{background:rgba(255,255,255,.2);color:#fff}
        .tela-vitoria{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#1a1a2e,#16213e);z-index:3000;align-items:center;justify-content:center;flex-direction:column}
        .tela-vitoria.active{display:flex}
        .confetti{position:fixed;width:15px;height:15px;top:-20px;animation:fall 3s linear infinite;z-index:3001}
        @keyframes fall{to{transform:translateY(100vh) rotate(720deg)}}
        .vencedor-container{text-align:center;z-index:3002}
        .vencedor-trofeu{font-size:8rem;animation:trofeu-bounce 1s ease infinite}
        @keyframes trofeu-bounce{0%,100%{transform:translateY(0) rotate(-5deg)}50%{transform:translateY(-30px) rotate(5deg)}}
        .vencedor-titulo{font-family:'Bangers',cursive;font-size:5rem;color:var(--yellow);margin:20px 0;animation:scale-pulse 1s ease infinite}
        @keyframes scale-pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .vencedor-foto{width:220px;height:220px;border-radius:50%;object-fit:cover;border:8px solid var(--yellow);box-shadow:0 0 80px rgba(255,215,0,.6);margin:30px 0}
        .vencedor-nome{font-family:'Fredoka One',cursive;font-size:3.5rem;color:#fff;margin-bottom:20px}
        .premio-vencedor{display:flex;align-items:center;justify-content:center;gap:20px;margin:30px 0;padding:20px 40px;background:rgba(255,215,0,.2);border-radius:20px;border:3px solid var(--yellow)}
        .premio-vencedor img{width:80px;height:80px;border-radius:15px;object-fit:cover}
        .premio-vencedor span{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--yellow)}
        .btn-novo-jogo{padding:25px 80px;font-size:2rem;font-family:'Bangers',cursive;background:linear-gradient(135deg,var(--green),#16a34a);color:#fff;border:none;border-radius:25px;cursor:pointer;margin-top:30px;box-shadow:0 10px 40px rgba(34,197,94,.5)}
        .btn-novo-jogo:hover{transform:scale(1.05)}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);padding:20px 40px;background:linear-gradient(135deg,rgba(0,0,0,.95),rgba(30,30,30,.95));color:#fff;border-radius:20px;font-weight:600;font-size:1.1rem;z-index:5000;transition:transform .4s cubic-bezier(.68,-.55,.265,1.55);border:2px solid rgba(255,255,255,.2)}
        .toast.active{transform:translateX(-50%) translateY(0)}
        .loading{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);z-index:6000;align-items:center;justify-content:center;flex-direction:column;gap:20px}
        .loading.active{display:flex}
        .spinner{width:80px;height:80px;border:6px solid rgba(255,255,255,.2);border-top-color:var(--yellow);border-radius:50%;animation:spin 1s linear infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        .loading-text{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--yellow)}
        .empty-state{text-align:center;padding:60px;color:rgba(255,255,255,.5)}
        .empty-state-icon{font-size:5rem;margin-bottom:20px;animation:float 3s ease-in-out infinite}
        .btn-voltar{padding:15px 30px;background:rgba(255,255,255,.1);border:2px solid rgba(255,255,255,.3);border-radius:15px;color:#fff;font-weight:600;cursor:pointer;margin-top:15px}
        .btn-voltar:hover{background:rgba(255,255,255,.2)}
        @media(max-width:1200px){.tela-inicial{grid-template-columns:1fr}.globo-container{width:320px;height:320px}.globo-esfera{width:280px;height:280px}.bola-sorteada{width:200px;height:200px}.letra-grande{font-size:4rem}.numero-grande{font-size:6rem}}
        @media(max-width:768px){.header{padding:15px 20px;flex-direction:column;gap:15px}.logo{font-size:2rem}.container{padding:15px}.jogo-titulo{font-size:2rem}.globo-container{width:260px;height:260px}.globo-esfera{width:220px;height:220px}.bola-sorteada{width:160px;height:160px}.letra-grande{font-size:3rem}.numero-grande{font-size:4.5rem}.regras-lista{grid-template-columns:1fr 1fr}.btn-sortear{padding:18px 40px;font-size:1.3rem}}
    </style>
</head>
<body>
    <header class="header">
        <h1 class="logo">üé∞ BINGO DOS VELOSO üé∞</h1>
        <button class="btn btn-reset" onclick="resetarTudo()">üîÑ RESET TOTAL</button>
    </header>
    <div class="container">
        <div class="tela-inicial" id="telaInicial">
            <div class="card">
                <h2 class="card-title"><span>üé™</span>CRIAR NOVA SALA</h2>
                <div class="form-group"><label>üè∑Ô∏è Nome da Sala</label><input type="text" id="nomeSala" placeholder='ex: "Bingo de Natal 2024"'></div>
                <div class="form-group"><label>üéÅ Foto do Pr√™mio (opcional)</label><div class="premio-upload" onclick="document.getElementById('inputPremio').click()"><div id="premioPreview"><div class="premio-icon">üéÅ</div><p>Clique para adicionar</p></div></div><input type="file" id="inputPremio" style="display:none" accept="image/*" onchange="handlePremio(event)"></div>
                <div class="form-group"><label>üìã Cartelas por Jogador</label><div class="slider-container"><input type="range" id="qtdCartelas" min="1" max="5" value="2" oninput="document.getElementById('sliderValue').textContent=this.value"><span class="slider-value" id="sliderValue">2</span></div></div>
                <button class="btn-primary" onclick="criarSala()">üé∞ CRIAR SALA</button>
            </div>
            <div class="card">
                <h2 class="card-title"><span>üéØ</span>SALAS ATIVAS</h2>
                <div class="salas-lista" id="salasLista"><div class="empty-state"><div class="empty-state-icon">üé±</div><p>Nenhuma sala ativa</p></div></div>
            </div>
        </div>
        <div class="tela-jogo" id="telaJogo">
            <div class="jogo-header">
                <h1 class="jogo-titulo" id="jogoTitulo">üé∞ BINGO üé∞</h1>
                <div class="premio-destaque" id="premioDestaque" style="display:none"><span class="premio-texto">üéÅ PR√äMIO:</span><img class="premio-img-grande" id="premioImgJogo" src="" alt="Pr√™mio"></div>
                <button class="btn-voltar" onclick="voltarInicio()">‚Üê Voltar</button>
            </div>
            <div class="globo-section">
                <div class="globo-container" id="globoContainer">
                    <div class="globo" id="globo"><div class="globo-esfera" id="globoEsfera"></div></div>
                    <div class="numero-sorteado-container" id="numeroSorteadoContainer"><div class="bola-sorteada" id="bolaSorteada"><span class="letra-grande" id="letraGrande">B</span><span class="numero-grande" id="numeroGrande">12</span></div></div>
                </div>
                <button class="btn-sortear" id="btnSortear" onclick="iniciarSorteio()">üé≤ GIRAR BOLAS</button>
            </div>
            <div class="reacoes-container" id="reacoesContainer"></div>
            <div class="numeros-sorteados-section">
                <h3 class="section-title">üìä N√öMEROS SORTEADOS</h3>
                <div class="numeros-grid-container" id="gradeNumeros"></div>
                <p class="contador-sorteados">Sorteados: <span id="contadorSorteados">0</span>/75</p>
            </div>
            <div class="alertas-section" id="alertasSection" style="display:none"><h3>üîî ALERTAS DE BINGO!</h3><div id="alertasLista"></div></div>
        </div>
    </div>
    <div class="modal" id="regrasModal"><div class="modal-content"><h2 class="regras-title">üìú REGRAS DO JOGO</h2><div class="regras-lista"><div class="regra-item"><div class="regra-icon">üì±</div><div class="regra-titulo">MARQUE R√ÅPIDO!</div><div class="regra-desc">Clique antes que desapare√ßa!</div></div><div class="regra-item"><div class="regra-icon">‚ûñ</div><div class="regra-titulo">LINHA</div><div class="regra-desc">Complete uma linha</div></div><div class="regra-item"><div class="regra-icon">|</div><div class="regra-titulo">COLUNA</div><div class="regra-desc">Complete uma coluna</div></div><div class="regra-item"><div class="regra-icon">‚ÜóÔ∏è</div><div class="regra-titulo">DIAGONAL</div><div class="regra-desc">Complete uma diagonal</div></div><div class="regra-item"><div class="regra-icon">‚úñÔ∏è</div><div class="regra-titulo">CRUZADA</div><div class="regra-desc">Duas diagonais (X)</div></div><div class="regra-item"><div class="regra-icon">üéØ</div><div class="regra-titulo">CARTELA CHEIA</div><div class="regra-desc">Todos os n√∫meros!</div></div></div><p style="margin-bottom:25px;color:rgba(255,255,255,.7);text-align:center">‚ö†Ô∏è Perdeu n√∫mero = BINGO inv√°lido!</p><button class="btn-iniciar-jogo" onclick="confirmarInicioJogo()">üéÆ INICIAR JOGO!</button></div></div>
    <div class="modal" id="modalJogadores"><div class="modal-content"><button class="modal-close" onclick="fecharModal('modalJogadores')">√ó</button><h2 class="card-title"><span>üë•</span>Jogadores</h2><div id="jogadoresLista"></div><p style="margin-top:25px;color:rgba(255,255,255,.6)" id="totalJogadores"></p></div></div>
    <div class="modal" id="modalVerificacao"><div class="modal-content" style="max-width:800px"><button class="modal-close" onclick="fecharModal('modalVerificacao')">√ó</button><h2 class="card-title"><span>üîç</span>Verificando BINGO</h2><p id="verificacaoNome" style="font-size:1.3rem;margin-bottom:20px"></p><div class="verificacao-cartela" id="verificacaoCartela"></div><div class="resultado-verificacao" id="resultadoVerificacao"></div><div class="modal-buttons" id="verificacaoButtons"></div></div></div>
    <div class="tela-vitoria" id="telaVitoria"><div class="vencedor-container"><div class="vencedor-trofeu">üèÜ</div><h1 class="vencedor-titulo">VENCEDOR!</h1><img class="vencedor-foto" id="vencedorFoto" src="" alt=""><h2 class="vencedor-nome" id="vencedorNome"></h2><div class="premio-vencedor" id="premioVencedor" style="display:none"><span>üéÅ</span><img id="premioVencedorImg" src="" alt=""><span>PARAB√âNS!</span></div><button class="btn-novo-jogo" onclick="novoJogo()">üé∞ NOVO JOGO</button></div></div>
    <div class="toast" id="toast"></div>
    <div class="loading" id="loading"><div class="spinner"></div><div class="loading-text">Carregando...</div></div>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig={apiKey:"AIzaSyCPYcph6zvKD-pIrDSwlL378hJKQoz-r2I",authDomain:"bingo-16f47.firebaseapp.com",databaseURL:"https://bingo-16f47-default-rtdb.firebaseio.com",projectId:"bingo-16f47",storageBucket:"bingo-16f47.firebasestorage.app",messagingSenderId:"549011622250",appId:"1:549011622250:web:d86e8112d2d108f239fd13"};
        firebase.initializeApp(firebaseConfig);const db=firebase.database();
        let salaAtual=null,salaAtualData=null,numerosSorteados=[],premioBase64=null,animacaoGiroInterval=null;
        document.addEventListener('DOMContentLoaded',()=>{carregarSalas();criarBolasGlobo()});
        const showToast=m=>{const t=document.getElementById('toast');t.textContent=m;t.classList.add('active');setTimeout(()=>t.classList.remove('active'),3000)};
        const showLoading=()=>document.getElementById('loading').classList.add('active');
        const hideLoading=()=>document.getElementById('loading').classList.remove('active');
        const fecharModal=id=>document.getElementById(id).classList.remove('active');
        const gerarId=()=>Date.now().toString(36)+Math.random().toString(36).substr(2);
        function handlePremio(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{const img=new Image();img.onload=()=>{const c=document.createElement('canvas');c.width=c.height=300;c.getContext('2d').drawImage(img,(img.width-Math.min(img.width,img.height))/2,(img.height-Math.min(img.width,img.height))/2,Math.min(img.width,img.height),Math.min(img.width,img.height),0,0,300,300);premioBase64=c.toDataURL('image/jpeg',.8);document.getElementById('premioPreview').innerHTML=`<img class="premio-preview" src="${premioBase64}"><p style="color:var(--yellow)">‚úÖ Adicionado!</p>`};img.src=ev.target.result};r.readAsDataURL(f)}
        async function criarSala(){const n=document.getElementById('nomeSala').value.trim(),c=parseInt(document.getElementById('qtdCartelas').value);if(!n){showToast('üìù Digite o nome!');return}showLoading();const id=gerarId();try{await db.ref('salas/'+id).set({nome:n,cartelasPorJogador:c,premio:premioBase64,ativa:true,jogando:false,girando:false,numeroAtual:null,letraAtual:null,faseAnimacao:'idle',numerosSorteados:[],vencedor:null,criadaEm:Date.now()});document.getElementById('nomeSala').value='';document.getElementById('premioPreview').innerHTML='<div class="premio-icon">üéÅ</div><p>Clique para adicionar</p>';premioBase64=null;showToast('‚úÖ Sala criada!')}catch(e){showToast('‚ùå Erro: '+e.message)}hideLoading()}
        function carregarSalas(){db.ref('salas').on('value',s=>renderizarSalas(s.val()||{}))}
        function renderizarSalas(salas){const l=document.getElementById('salasLista'),atv=Object.entries(salas).filter(([_,s])=>s.ativa);if(!atv.length){l.innerHTML='<div class="empty-state"><div class="empty-state-icon">üé±</div><p>Nenhuma sala ativa</p></div>';return}l.innerHTML=atv.map(([id,s])=>{const url=`${location.origin}${location.pathname.replace('index.html','')}jogador.html?sala=${id}`;return`<div class="sala-card"><div class="sala-header"><div class="sala-nome">üé∞ ${s.nome}</div>${s.premio?`<img class="sala-premio" src="${s.premio}">`:''}</div><div class="sala-info"><div class="sala-info-item"><span>üìã</span><span>${s.cartelasPorJogador} cartela(s)</span></div><div class="sala-info-item" id="jog-${id}"><span>üë•</span><span>...</span></div></div><div class="qr-container" id="qr-${id}"></div><div class="sala-buttons">${s.jogando?`<button class="btn-sala btn-iniciar" onclick="entrarJogo('${id}')">‚ñ∂Ô∏è CONTINUAR</button>`:`<button class="btn-sala btn-iniciar" onclick="mostrarRegras('${id}')">üéÆ INICIAR</button>`}<button class="btn-sala btn-jogadores" onclick="verJogadores('${id}')">üë• JOGADORES</button><button class="btn-sala btn-encerrar" onclick="encerrarSala('${id}')">üóëÔ∏è ENCERRAR</button></div></div>`}).join('');atv.forEach(([id])=>{const url=`${location.origin}${location.pathname.replace('index.html','')}jogador.html?sala=${id}`,qr=document.getElementById('qr-'+id);if(qr){qr.innerHTML='';new QRCode(qr,{text:url,width:180,height:180})}db.ref('jogadores').orderByChild('salaId').equalTo(id).on('value',snap=>{const el=document.getElementById('jog-'+id);if(el)el.innerHTML=`<span>üë•</span><span>${Object.keys(snap.val()||{}).length}</span>`})})}
        async function verJogadores(salaId){const snap=await db.ref('jogadores').orderByChild('salaId').equalTo(salaId).once('value'),jogs=snap.val()||{},salaSnap=await db.ref('salas/'+salaId).once('value'),sala=salaSnap.val(),l=document.getElementById('jogadoresLista'),arr=Object.entries(jogs);if(!arr.length)l.innerHTML='<div class="empty-state"><p>Nenhum jogador</p></div>';else l.innerHTML=arr.map(([id,j])=>`<div class="jogador-item"><div class="jogador-info"><img class="jogador-foto" src="${j.foto||'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%234ecdc4%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2260%22 text-anchor=%22middle%22 font-size=%2240%22>üë§</text></svg>'}"><div><div class="jogador-nome">${j.nome} ${j.sobrenome}</div><div class="jogador-cartelas-info">${j.cartelas?.length||sala.cartelasPorJogador} cartela(s)</div></div></div><div class="jogador-cartelas-edit"><input type="number" class="cartelas-input" id="cart-${id}" value="${j.cartelas?.length||sala.cartelasPorJogador}" min="1" max="10"><button class="btn-salvar-cartelas" onclick="atualizarCartelas('${id}','${salaId}')">üíæ</button></div></div>`).join('');let tot=0;arr.forEach(([_,j])=>tot+=j.cartelas?.length||sala.cartelasPorJogador);document.getElementById('totalJogadores').textContent=`üìä ${arr.length} jogadores, ${tot} cartelas`;document.getElementById('modalJogadores').classList.add('active')}
        async function atualizarCartelas(jId,sId){const q=parseInt(document.getElementById('cart-'+jId).value);if(q<1||q>10){showToast('‚ùå 1-10 cartelas');return}showLoading();try{const snap=await db.ref('jogadores/'+jId).once('value'),j=snap.val();let carts=[...(j.cartelas||[])];if(q>carts.length)for(let i=carts.length;i<q;i++)carts.push(gerarCartela(i));else carts=carts.slice(0,q);await db.ref('jogadores/'+jId+'/cartelas').set(carts);showToast('‚úÖ Atualizado!');verJogadores(sId)}catch(e){showToast('‚ùå '+e.message)}hideLoading()}
        function gerarCartela(idx){const gen=(mi,ma,qt)=>{const n=[];while(n.length<qt){const x=Math.floor(Math.random()*(ma-mi+1))+mi;if(!n.includes(x))n.push(x)}return n};const B=gen(1,15,5),I=gen(16,30,5),N=gen(31,45,4),G=gen(46,60,5),O=gen(61,75,5),nums=[];for(let l=0;l<5;l++)nums.push([B[l],I[l],l===2?0:N[l<2?l:l-1],G[l],O[l]]);return{id:idx+1,numeros:nums,marcados:[0],totalMarcados:1}}
        let salaParaIniciar=null;
        const mostrarRegras=id=>{salaParaIniciar=id;document.getElementById('regrasModal').classList.add('active')};
        async function confirmarInicioJogo(){document.getElementById('regrasModal').classList.remove('active');if(salaParaIniciar)await iniciarJogo(salaParaIniciar)}
        async function iniciarJogo(sId){showLoading();try{await db.ref('salas/'+sId).update({jogando:true,girando:false,numeroAtual:null,letraAtual:null,faseAnimacao:'idle',numerosSorteados:[],vencedor:null,alertasBingo:null});entrarJogo(sId)}catch(e){showToast('‚ùå '+e.message)}hideLoading()}
        function entrarJogo(sId){salaAtual=sId;document.getElementById('telaInicial').style.display='none';document.getElementById('telaJogo').classList.add('active');db.ref('salas/'+sId).on('value',snap=>{const s=snap.val();if(!s)return;salaAtualData=s;document.getElementById('jogoTitulo').textContent=`üé∞ ${s.nome} üé∞`;numerosSorteados=s.numerosSorteados||[];if(s.premio){document.getElementById('premioDestaque').style.display='flex';document.getElementById('premioImgJogo').src=s.premio}else document.getElementById('premioDestaque').style.display='none';renderizarGrade();document.getElementById('contadorSorteados').textContent=numerosSorteados.length;atualizarEstadoSorteio(s);if(s.vencedor)mostrarVencedor(s.vencedor,s.premio)});db.ref('salas/'+sId+'/reacoes').on('child_added',snap=>{mostrarReacao(snap.val());setTimeout(()=>db.ref('salas/'+sId+'/reacoes/'+snap.key).remove(),4000)});db.ref('salas/'+sId+'/alertasBingo').on('value',snap=>renderizarAlertas(Object.entries(snap.val()||{})))}
        function atualizarEstadoSorteio(s){const btn=document.getElementById('btnSortear'),cont=document.getElementById('numeroSorteadoContainer');if(s.girando){btn.textContent='‚úã PARAR!';btn.classList.add('girando');cont.classList.remove('active');animarBolasGlobo()}else if(s.faseAnimacao==='letra'){btn.disabled=true;btn.textContent='üé≤ GIRAR BOLAS';btn.classList.remove('girando');pararAnimacaoBolas();mostrarLetra(s.letraAtual)}else if(s.faseAnimacao==='numero'){btn.disabled=true;mostrarNumero(s.numeroAtual)}else{btn.textContent='üé≤ GIRAR BOLAS';btn.classList.remove('girando');btn.disabled=false;cont.classList.remove('active');pararAnimacaoBolas()}}
        function criarBolasGlobo(){const e=document.getElementById('globoEsfera'),cores={B:'bola-b',I:'bola-i',N:'bola-n',G:'bola-g',O:'bola-o'};for(let i=0;i<12;i++){const b=document.createElement('div');b.className='bola-bingo';const l=['B','I','N','G','O'][Math.floor(Math.random()*5)];b.classList.add(cores[l]);b.style.top=(15+Math.random()*70)+'%';b.style.left=(15+Math.random()*70)+'%';const num=l==='B'?Math.floor(Math.random()*15)+1:l==='I'?Math.floor(Math.random()*15)+16:l==='N'?Math.floor(Math.random()*15)+31:l==='G'?Math.floor(Math.random()*15)+46:Math.floor(Math.random()*15)+61;b.textContent=num;e.appendChild(b)}}
        function animarBolasGlobo(){if(animacaoGiroInterval)return;const bolas=document.querySelectorAll('.bola-bingo');animacaoGiroInterval=setInterval(()=>{bolas.forEach(b=>{b.style.transition='all .25s ease';b.style.top=(10+Math.random()*75)+'%';b.style.left=(10+Math.random()*75)+'%'})},250)}
        function pararAnimacaoBolas(){if(animacaoGiroInterval){clearInterval(animacaoGiroInterval);animacaoGiroInterval=null}}
        async function iniciarSorteio(){if(salaAtualData.girando)await pararESortear();else await db.ref('salas/'+salaAtual).update({girando:true,faseAnimacao:'girando'})}
        async function pararESortear(){const disp=[];for(let i=1;i<=75;i++)if(!numerosSorteados.includes(i))disp.push(i);if(!disp.length){showToast('üéâ Todos sorteados!');await db.ref('salas/'+salaAtual).update({girando:false,faseAnimacao:'idle'});return}const num=disp[Math.floor(Math.random()*disp.length)],let_=getLetra(num);await db.ref('salas/'+salaAtual).update({girando:false,letraAtual:let_,faseAnimacao:'letra'});playSound('letra');setTimeout(async()=>{await db.ref('salas/'+salaAtual).update({numeroAtual:num,faseAnimacao:'numero',numerosSorteados:[...numerosSorteados,num]});playSound('numero');setTimeout(async()=>{await db.ref('salas/'+salaAtual).update({numeroAtual:null,letraAtual:null,faseAnimacao:'idle'})},5000)},3000)}
        const getLetra=n=>n<=15?'B':n<=30?'I':n<=45?'N':n<=60?'G':'O';
        function mostrarLetra(l){const cont=document.getElementById('numeroSorteadoContainer'),bola=document.getElementById('bolaSorteada'),letEl=document.getElementById('letraGrande'),numEl=document.getElementById('numeroGrande'),cores={B:'linear-gradient(135deg,#ef4444,#dc2626)',I:'linear-gradient(135deg,#f59e0b,#d97706)',N:'linear-gradient(135deg,#22c55e,#16a34a)',G:'linear-gradient(135deg,#3b82f6,#2563eb)',O:'linear-gradient(135deg,#a855f7,#9333ea)'};bola.style.background=cores[l];letEl.textContent=l;numEl.classList.remove('visible');numEl.textContent='';cont.classList.add('active')}
        function mostrarNumero(n){const numEl=document.getElementById('numeroGrande');numEl.textContent=n;numEl.classList.add('visible')}
        function mostrarReacao(r){const cont=document.getElementById('reacoesContainer'),div=document.createElement('div');div.className='reacao';div.innerHTML=`<img class="reacao-foto" src="${r.foto||'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%234ecdc4%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2260%22 text-anchor=%22middle%22 font-size=%2240%22>üë§</text></svg>'}"><span class="reacao-nome">${r.nome}</span><span class="reacao-icon">‚úÖ</span>`;cont.appendChild(div);setTimeout(()=>div.remove(),3500)}
        function renderizarGrade(){const c=document.getElementById('gradeNumeros');let h='<div class="letras-header"><div class="letra-col b">B</div><div class="letra-col i">I</div><div class="letra-col n">N</div><div class="letra-col g">G</div><div class="letra-col o">O</div></div><div class="numeros-colunas">';[[1,15,'b'],[16,30,'i'],[31,45,'n'],[46,60,'g'],[61,75,'o']].forEach(([mi,ma,l])=>{h+='<div class="coluna-numeros">';for(let i=mi;i<=ma;i++)h+=`<div class="numero-cell ${numerosSorteados.includes(i)?'sorteado '+l:''}">${i}</div>`;h+='</div>'});h+='</div>';c.innerHTML=h}
        function renderizarAlertas(alertas){const sec=document.getElementById('alertasSection'),lst=document.getElementById('alertasLista');if(!alertas.length){sec.style.display='none';return}sec.style.display='block';lst.innerHTML=alertas.map(([id,a])=>`<div class="alerta-item"><div class="alerta-info"><img class="alerta-foto" src="${a.foto||'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%234ecdc4%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2260%22 text-anchor=%22middle%22 font-size=%2240%22>üë§</text></svg>'}"><div><div class="alerta-nome">${a.jogadorNome}</div><div class="alerta-cartela">Cartela ${a.cartelaIndex+1}</div></div></div><div class="alerta-buttons"><button class="btn-verificar" onclick="verificarBingo('${a.jogadorId}',${a.cartelaIndex},'${id}')">‚úÖ VERIFICAR</button><button class="btn-ignorar" onclick="ignorarBingo('${id}')">‚ùå</button></div></div>`).join('')}
        async function verificarBingo(jId,cIdx,aId){showLoading();try{const snap=await db.ref('jogadores/'+jId).once('value'),j=snap.val();if(!j?.cartelas){showToast('‚ùå N√£o encontrado');hideLoading();return}const cart=j.cartelas[cIdx],marc=cart.marcados||[],perd=[];cart.numeros.flat().filter(n=>n!==0).forEach(n=>{if(numerosSorteados.includes(n)&&!marc.includes(n))perd.push(n)});const seq=verificarSequencias(cart.numeros,marc);renderizarVerificacao(j,cart,marc,perd,seq,aId)}catch(e){showToast('‚ùå '+e.message)}hideLoading()}
        function verificarSequencias(nums,marc){const s={linhas:[],colunas:[],diagonais:[],cruzada:false,cartelaCheia:true};for(let i=0;i<5;i++)if(nums[i].every(n=>n===0||marc.includes(n)))s.linhas.push(i);for(let c=0;c<5;c++)if(nums.map(l=>l[c]).every(n=>n===0||marc.includes(n)))s.colunas.push(c);if([nums[0][0],nums[1][1],nums[2][2],nums[3][3],nums[4][4]].every(n=>n===0||marc.includes(n)))s.diagonais.push('d1');if([nums[0][4],nums[1][3],nums[2][2],nums[3][1],nums[4][0]].every(n=>n===0||marc.includes(n)))s.diagonais.push('d2');if(s.diagonais.length===2)s.cruzada=true;s.cartelaCheia=nums.flat().filter(n=>n!==0).every(n=>marc.includes(n));return s}
        function renderizarVerificacao(j,cart,marc,perd,seq,aId){document.getElementById('verificacaoNome').innerHTML=`<strong>${j.nome} ${j.sobrenome}</strong> - Cartela ${cart.id}`;const g=document.getElementById('verificacaoCartela');g.innerHTML='<div class="verificacao-header">B</div><div class="verificacao-header">I</div><div class="verificacao-header">N</div><div class="verificacao-header">G</div><div class="verificacao-header">O</div>';for(let r=0;r<5;r++)for(let c=0;c<5;c++){const n=cart.numeros[r][c];let cls='verificacao-cell';if(n===0)cls+=' coringa';else if(marc.includes(n))cls+=' marcado-correto';else if(numerosSorteados.includes(n))cls+=' nao-marcou';if(seq.linhas.includes(r)||seq.colunas.includes(c)||(seq.diagonais.includes('d1')&&r===c)||(seq.diagonais.includes('d2')&&r+c===4))cls+=' sequencia';g.innerHTML+=`<div class="${cls}">${n===0?'‚≠ê':n}</div>`}const res=document.getElementById('resultadoVerificacao'),tem=seq.linhas.length||seq.colunas.length||seq.diagonais.length||seq.cartelaCheia,valido=!perd.length&&tem;if(valido){let tipos=[];if(seq.cartelaCheia)tipos.push('üéØ CARTELA CHEIA');if(seq.cruzada)tipos.push('‚úñÔ∏è CRUZADA');if(seq.linhas.length)tipos.push(`‚ûñ ${seq.linhas.length} LINHA(S)`);if(seq.colunas.length)tipos.push(`| ${seq.colunas.length} COLUNA(S)`);if(seq.diagonais.length&&!seq.cruzada)tipos.push('‚ÜóÔ∏è DIAGONAL');res.className='resultado-verificacao valido';res.innerHTML=`<h3 class="resultado-titulo" style="color:var(--green)">‚úÖ BINGO V√ÅLIDO!</h3><p>${tipos.join(' ‚Ä¢ ')}</p>`}else{res.className='resultado-verificacao invalido';res.innerHTML=`<h3 class="resultado-titulo" style="color:var(--red)">‚ùå BINGO INV√ÅLIDO!</h3>${perd.length?`<p>Perdeu ${perd.length} n√∫mero(s):</p><div class="numeros-perdidos-lista">${perd.map(n=>`<span class="numero-perdido">${getLetra(n)} ${n}</span>`).join('')}</div>`:'<p>Sem sequ√™ncia v√°lida</p>'}`}document.getElementById('verificacaoButtons').innerHTML=valido?`<button class="btn-vencedor" onclick="declararVencedor('${j.nome} ${j.sobrenome}','${j.foto||''}','${aId}')">üèÜ DECLARAR VENCEDOR</button><button class="btn-continuar" onclick="fecharModal('modalVerificacao')">‚ñ∂Ô∏è CONTINUAR</button>`:`<button class="btn-continuar" onclick="fecharModal('modalVerificacao');ignorarBingo('${aId}')">‚ñ∂Ô∏è CONTINUAR</button>`;document.getElementById('modalVerificacao').classList.add('active')}
        async function ignorarBingo(aId){await db.ref('salas/'+salaAtual+'/alertasBingo/'+aId).remove()}
        async function declararVencedor(nome,foto,aId){fecharModal('modalVerificacao');await db.ref('salas/'+salaAtual).update({jogando:false,vencedor:{nome,foto}});await db.ref('salas/'+salaAtual+'/alertasBingo/'+aId).remove();mostrarVencedor({nome,foto},salaAtualData.premio)}
        function mostrarVencedor(v,premio){document.getElementById('vencedorNome').textContent=v.nome;document.getElementById('vencedorFoto').src=v.foto||'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%23ffd700%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2265%22 text-anchor=%22middle%22 font-size=%2250%22>üèÜ</text></svg>';if(premio){document.getElementById('premioVencedor').style.display='flex';document.getElementById('premioVencedorImg').src=premio}else document.getElementById('premioVencedor').style.display='none';document.getElementById('telaVitoria').classList.add('active');criarConfetes();playSound('vitoria')}
        function criarConfetes(){const cores=['#ef4444','#f59e0b','#22c55e','#3b82f6','#a855f7','#ffd700','#ec4899','#4ecdc4'],cont=document.getElementById('telaVitoria');for(let i=0;i<150;i++){const c=document.createElement('div');c.className='confetti';c.style.left=Math.random()*100+'%';c.style.background=cores[Math.floor(Math.random()*cores.length)];c.style.animationDelay=Math.random()*3+'s';c.style.animationDuration=(2+Math.random()*3)+'s';c.style.width=c.style.height=(8+Math.random()*12)+'px';c.style.borderRadius=Math.random()>.5?'50%':'0';cont.appendChild(c)}}
        async function novoJogo(){document.querySelectorAll('.confetti').forEach(c=>c.remove());document.getElementById('telaVitoria').classList.remove('active');await db.ref('salas/'+salaAtual).update({jogando:true,girando:false,numeroAtual:null,letraAtual:null,faseAnimacao:'idle',numerosSorteados:[],vencedor:null,alertasBingo:null,reacoes:null});const snap=await db.ref('jogadores').orderByChild('salaId').equalTo(salaAtual).once('value'),jogs=snap.val()||{};for(const[id,j]of Object.entries(jogs)){if(j.cartelas){await db.ref('jogadores/'+id+'/cartelas').set(j.cartelas.map(c=>({...c,marcados:[0],totalMarcados:1})));await db.ref('jogadores/'+id+'/gritouBingo').set(false)}}showToast('üé∞ Novo jogo!')}
        function voltarInicio(){salaAtual=null;salaAtualData=null;document.getElementById('telaInicial').style.display='grid';document.getElementById('telaJogo').classList.remove('active');pararAnimacaoBolas()}
        async function encerrarSala(sId){if(!confirm('‚ö†Ô∏è Encerrar sala?'))return;showLoading();try{const snap=await db.ref('jogadores').orderByChild('salaId').equalTo(sId).once('value');for(const id of Object.keys(snap.val()||{}))await db.ref('jogadores/'+id).remove();await db.ref('salas/'+sId).update({ativa:false});showToast('‚úÖ Encerrada!')}catch(e){showToast('‚ùå '+e.message)}hideLoading()}
        async function resetarTudo(){if(!confirm('‚ö†Ô∏è APAGAR TUDO?'))return;if(!confirm('üö® CERTEZA?'))return;showLoading();try{await db.ref('salas').remove();await db.ref('jogadores').remove();if(salaAtual)voltarInicio();showToast('‚úÖ Resetado!')}catch(e){showToast('‚ùå '+e.message)}hideLoading()}
        function playSound(tipo){try{const ctx=new(window.AudioContext||window.webkitAudioContext)();if(tipo==='letra'||tipo==='numero'){const osc=ctx.createOscillator(),gain=ctx.createGain();osc.connect(gain);gain.connect(ctx.destination);osc.frequency.setValueAtTime(tipo==='letra'?400:800,ctx.currentTime);osc.frequency.exponentialRampToValueAtTime(tipo==='letra'?800:1200,ctx.currentTime+.15);gain.gain.setValueAtTime(.3,ctx.currentTime);gain.gain.exponentialRampToValueAtTime(.01,ctx.currentTime+.3);osc.start(ctx.currentTime);osc.stop(ctx.currentTime+.3)}else if(tipo==='vitoria'){[523,659,784,880,1047].forEach((n,i)=>{setTimeout(()=>{const osc=ctx.createOscillator(),gain=ctx.createGain();osc.connect(gain);gain.connect(ctx.destination);osc.frequency.value=n;gain.gain.setValueAtTime(.4,ctx.currentTime);gain.gain.exponentialRampToValueAtTime(.01,ctx.currentTime+.4);osc.start(ctx.currentTime);osc.stop(ctx.currentTime+.4)},i*150)})}}catch(e){}}
    </script>
</body>
</html>
